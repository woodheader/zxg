{"version":3,"sources":["webpack:///E:/项目/业小管/mini/pages/login/components/mp-weixin-mobile.vue?80aa","webpack:///E:/项目/业小管/mini/pages/login/components/mp-weixin-mobile.vue?2d80","webpack:///E:/项目/业小管/mini/pages/login/components/mp-weixin-mobile.vue?bba4","webpack:///E:/项目/业小管/mini/pages/login/components/mp-weixin-mobile.vue?f509","uni-app:///pages/login/components/mp-weixin-mobile.vue","webpack:///E:/项目/业小管/mini/pages/login/components/mp-weixin-mobile.vue?a9c0","webpack:///E:/项目/业小管/mini/pages/login/components/mp-weixin-mobile.vue?d33c"],"names":["props","isParty","type","default","partyData","data","code","methods","clickPhoneNumber","handelMpWeixinMobileLogin","detail","app","console","store","encryptedData","iv","refereeId","then","setTimeout","catch","finally","getCode","uni","provider","success","resolve","fail","onNavigateBack","delta"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyI;AACzI;AACoE;AACL;AACsC;;;AAGrG;AAC+K;AAC/K,gBAAgB,wLAAU;AAC1B,EAAE,sFAAM;AACR,EAAE,uGAAM;AACR,EAAE,gHAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,2GAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA4pB,CAAgB,irBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACchrB;AACA;;;;;;;;;;;;;;gBAEA;EACAA;IACA;IACAC;MACAC;MACAC;QAAA;MAAA;IACA;IACA;IACAC;MACAF;IACA;EACA;EAEAG;IACA;MACA;MACA;MACAC;IACA;EACA;EAEAC;IAEA;IACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;cAAA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAAC;gBACAC;gBAAA,MACAD;kBAAA;kBAAA;gBAAA;gBACAE;gBACA;gBAAA;cAAA;gBAGAD;gBACAE;kBACAP;kBACAQ;kBACAC;kBACAd;kBACAG;kBACAY;gBACA,GACAC;kBACA;kBACAN;kBACA;kBACAO;oBACAP;kBACA;gBACA,GACAQ;kBACA;kBACA;kBACA;oBACAR;kBACA;kBACA;kBACA;oBACAO;sBAAA;oBAAA;kBACA;gBACA,GACAE;kBAAA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACA;IACAC;MACA;QACAC;UACAC;UACAC;YACAZ;YACAa;UACA;UACAC;QACA;MACA;IACA;IAEA;AACA;AACA;IACAC;MAAA;MACA;MACA;QACAL;UACAM;QACA;MACA;QACA;MACA;IACA;EAEA;AACA;AAAA,4B;;;;;;;;;;;;;ACrHA;AAAA;AAAA;AAAA;AAAuwC,CAAgB,ouCAAG,EAAC,C;;;;;;;;;;;ACA3xC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/login/components/mp-weixin-mobile.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./mp-weixin-mobile.vue?vue&type=template&id=6b269066&scoped=true&\"\nvar renderjs\nimport script from \"./mp-weixin-mobile.vue?vue&type=script&lang=js&\"\nexport * from \"./mp-weixin-mobile.vue?vue&type=script&lang=js&\"\nimport style0 from \"./mp-weixin-mobile.vue?vue&type=style&index=0&id=6b269066&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6b269066\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/login/components/mp-weixin-mobile.vue\"\nexport default component.exports","export * from \"-!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mp-weixin-mobile.vue?vue&type=template&id=6b269066&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mp-weixin-mobile.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mp-weixin-mobile.vue?vue&type=script&lang=js&\"","<template>\r\n  <!-- 微信授权手机号一键登录 -->\r\n  <view class=\"wechat-auth\">\r\n    <button class=\"btn-normal\" open-type=\"getPhoneNumber\" @getphonenumber=\"handelMpWeixinMobileLogin($event)\"\r\n      @click=\"clickPhoneNumber\">\r\n      <view class=\"wechat-auth-container\">\r\n        <image class=\"icon\" src=\"../../../static/channel/wechat.png\"></image>\r\n        <text class=\"title\">微信手机号一键登录</text>\r\n      </view>\r\n    </button>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n  import store from '@/store'\r\n  import { isEmpty } from '@/utils/util'\r\n\r\n  export default {\r\n    props: {\r\n      // 是否存在第三方用户信息\r\n      isParty: {\r\n        type: Boolean,\r\n        default: () => false\r\n      },\r\n      // 第三方用户信息数据\r\n      partyData: {\r\n        type: Object\r\n      }\r\n    },\r\n\r\n    data() {\r\n      return {\r\n        // 微信小程序登录凭证 (code)\r\n        // 提交到后端，用于换取openid\r\n        code: ''\r\n      }\r\n    },\r\n\r\n    methods: {\r\n\r\n      // 按钮点击事件: 获取微信手机号按钮\r\n      // 实现目的: 在getphonenumber事件触发之前获取微信登录code\r\n      // 因为如果在getphonenumber事件中获取code的话,提交到后端的encryptedData会存在解密不了的情况\r\n      async clickPhoneNumber() {\r\n        this.code = await this.getCode()\r\n      },\r\n\r\n      // 微信授权获取手机号一键登录\r\n      // getphonenumber事件的回调方法\r\n      async handelMpWeixinMobileLogin({ detail }) {\r\n        const app = this\r\n        if (detail.errMsg != 'getPhoneNumber:ok') {\r\n          console.log('微信授权获取手机号失败', detail.errMsg)\r\n          // app.$error(detail.errMsg)\r\n          return\r\n        }\r\n        app.isLoading = true\r\n        store.dispatch('LoginMpWxMobile', {\r\n            code: app.code,\r\n            encryptedData: detail.encryptedData,\r\n            iv: detail.iv,\r\n            isParty: app.isParty,\r\n            partyData: app.partyData,\r\n            refereeId: store.getters.refereeId\r\n          })\r\n          .then(result => {\r\n            // 显示登录成功\r\n            app.$toast(result.message)\r\n            // 跳转回原页面\r\n            setTimeout(() => {\r\n              app.onNavigateBack(1)\r\n            }, 2000)\r\n          })\r\n          .catch(err => {\r\n            const resultData = err.result.data\r\n            // 显示错误信息\r\n            if (isEmpty(resultData)) {\r\n              app.$toast(err.result.message)\r\n            }\r\n            // 跳转回原页面\r\n            if (resultData.isBack) {\r\n              setTimeout(() => app.onNavigateBack(1), 2000)\r\n            }\r\n          })\r\n          .finally(() => app.isLoading = false)\r\n      },\r\n\r\n      // 获取微信登录的code\r\n      // https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html\r\n      getCode() {\r\n        return new Promise((resolve, reject) => {\r\n          uni.login({\r\n            provider: 'weixin',\r\n            success: res => {\r\n              console.log('code', res.code)\r\n              resolve(res.code)\r\n            },\r\n            fail: reject\r\n          })\r\n        })\r\n      },\r\n\r\n      /**\r\n       * 登录成功-跳转回原页面\r\n       */\r\n      onNavigateBack(delta = 1) {\r\n        const pages = getCurrentPages()\r\n        if (pages.length > 1) {\r\n          uni.navigateBack({\r\n            delta: Number(delta || 1)\r\n          })\r\n        } else {\r\n          this.$navTo('pages/index/index')\r\n        }\r\n      }\r\n\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  // 微信授权登录\r\n  .wechat-auth {\r\n    width: 320rpx;\r\n    margin: 50rpx auto 0 auto;\r\n\r\n    .wechat-auth-container {\r\n      display: flex;\r\n      justify-content: center;\r\n    }\r\n\r\n    .icon {\r\n      width: 38rpx;\r\n      height: 38rpx;\r\n      margin-right: 15rpx;\r\n    }\r\n\r\n    .title {\r\n      font-size: 28rpx;\r\n      color: #666666;\r\n    }\r\n  }\r\n</style>\r\n","import mod from \"-!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mp-weixin-mobile.vue?vue&type=style&index=0&id=6b269066&lang=scss&scoped=true&\"; export default mod; export * from \"-!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\ruanjian\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./mp-weixin-mobile.vue?vue&type=style&index=0&id=6b269066&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1689298246917\n      var cssReload = require(\"D:/ruanjian/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}